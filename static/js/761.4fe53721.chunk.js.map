{"version":3,"file":"static/js/761.4fe53721.chunk.js","mappings":"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","sources":["pages/Invoice/InvoiceDetail.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\n// Make sure this path matches where your api.js actually is!\r\nimport api from \"../../api/api\"; \r\nimport \"./InvoiceDetail.css\"; \r\n\r\nconst InvoiceDetail = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  const [invoice, setInvoice] = useState(null);\r\n  const [lines, setLines] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // üëá FIX: Changed from localStorage to sessionStorage to match your App.jsx\r\n  const access = sessionStorage.getItem(\"access\");\r\n\r\n  const fetchInvoice = useCallback(async () => {\r\n    if (!id) return;\r\n    setLoading(true);\r\n    try {\r\n      const [invRes, linesRes] = await Promise.all([\r\n        api.get(`/invoice/invoices/${id}/`),\r\n        api.get(`/invoice/invoicelines/?invoice=${id}`),\r\n      ]);\r\n      setInvoice(invRes.data);\r\n      setLines(linesRes.data);\r\n    } catch (err) {\r\n      console.error(\"Failed to load invoice detail:\", err);\r\n      setError(\"Could not load invoice details.\");\r\n      // Handle token expiration\r\n      if (err.response && err.response.status === 401) {\r\n          navigate(\"/login\");\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [id, navigate]);\r\n\r\n  useEffect(() => {\r\n    // üëá FIX: Checks sessionStorage. If missing, goes to Login.\r\n    if (!access) {\r\n        navigate(\"/login\");\r\n    } else {\r\n        fetchInvoice();\r\n    }\r\n  }, [fetchInvoice, access, navigate]);\r\n\r\n  // ... (The rest of the rendering code remains exactly the same)\r\n  if (loading) return <div className=\"invoice-detail-page\"><p className=\"loading-text\">Loading Details...</p></div>;\r\n  if (error) return <div className=\"invoice-detail-page\"><p className=\"error-text\">{error}</p><button className=\"back-btn\" onClick={() => navigate(\"/invoices\")}>Go Back</button></div>;\r\n  if (!invoice) return null;\r\n\r\n  const subtotal = lines.reduce((sum, l) => sum + (parseFloat(l.charges) || 0) - (parseFloat(l.credits) || 0), 0);\r\n  const vat = subtotal * 0.15;\r\n  const total = subtotal + vat;\r\n\r\n  return (\r\n    <div className=\"invoice-detail-page\">\r\n      <div className=\"detail-actions\">\r\n          <button className=\"back-btn\" onClick={() => navigate(\"/invoices\")}>‚Üê Back to List</button>\r\n      </div>\r\n\r\n      <div className=\"invoice-paper\">\r\n        <header className=\"paper-header\">\r\n          <div className=\"brand-section\">\r\n            <h1>The Pumpkin Hotel (Pvt) Ltd</h1>\r\n            <p>Head Office: 29 Scanlen Drive, Borrowdale, Harare</p>\r\n            <p>Stand 604 Kotwa ‚Ä¢ P.O. Box 51</p>\r\n            <p className=\"vat-line\"><b>VAT No:</b> {invoice.vat_number}</p>\r\n          </div>\r\n          <div className=\"meta-section\">\r\n            <h2>TAX INVOICE</h2>\r\n            <div className=\"invoice-number-box\">\r\n                <span>No:</span> {invoice.invoice_number}\r\n            </div>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"info-grid\">\r\n            <div className=\"info-column\">\r\n                <h3>Bill To:</h3>\r\n                <p><b>Name:</b> {invoice.name}</p>\r\n                <p><b>Address:</b> {invoice.address}</p>\r\n            </div>\r\n        </div>\r\n\r\n        <section className=\"stay-details-grid\">\r\n          <div className=\"detail-item\"><label>Arrival</label><span>{invoice.arrival_date}</span></div>\r\n          <div className=\"detail-item\"><label>Departure</label><span>{invoice.departure_date}</span></div>\r\n          <div className=\"detail-item\"><label>Room</label><span>{invoice.room_no}</span></div>\r\n          <div className=\"detail-item\"><label>Type</label><span>{invoice.room_type}</span></div>\r\n          <div className=\"detail-item\"><label>Adults</label><span>{invoice.adults}</span></div>\r\n          <div className=\"detail-item\"><label>Kids</label><span>{invoice.children}</span></div>\r\n          <div className=\"detail-item\"><label>Rate</label><span>{invoice.rate_allocated}</span></div>\r\n          <div className=\"detail-item\"><label>Account</label><span>{invoice.company_account_no}</span></div>\r\n          <div className=\"detail-item\"><label>Recep</label><span>{invoice.receptionist}</span></div>\r\n        </section>\r\n\r\n        <table className=\"paper-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Date</th>\r\n              <th>Description</th>\r\n              <th>Voucher</th>\r\n              <th>Charges</th>\r\n              <th>Credits</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {lines.map((line, i) => (\r\n              <tr key={i}>\r\n                <td>{line.date}</td>\r\n                <td>{line.description}</td>\r\n                <td>{line.voucher}</td>\r\n                <td>{line.charges}</td>\r\n                <td>{line.credits}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div className=\"paper-totals\">\r\n          <div className=\"total-row\"><span>Sub Total:</span> <span>${subtotal.toFixed(2)}</span></div>\r\n          <div className=\"total-row\"><span>VAT (15%):</span> <span>${vat.toFixed(2)}</span></div>\r\n          <div className=\"total-row final\"><span>Total:</span> <span>${total.toFixed(2)}</span></div>\r\n        </div>\r\n\r\n        <div className=\"paper-footer\">\r\n          <p>Guest Signature: _________________________</p>\r\n          <div className=\"download-section\">\r\n            <a\r\n                href={`${process.env.REACT_APP_API_BASE_URL || \"http://localhost:8000/api/v2\"}/invoice/invoices/${id}/pdf/`}\r\n                target=\"_blank\"\r\n                rel=\"noreferrer\"\r\n                className=\"pdf-download-btn\"\r\n            >\r\n                Download Official PDF\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceDetail;"],"names":["InvoiceDetail","id","useParams","navigate","useNavigate","invoice","setInvoice","useState","lines","setLines","loading","setLoading","error","setError","access","sessionStorage","getItem","fetchInvoice","useCallback","async","invRes","linesRes","Promise","all","api","get","concat","data","err","console","response","status","useEffect","_jsx","className","children","_jsxs","onClick","subtotal","reduce","sum","l","parseFloat","charges","credits","vat","total","vat_number","invoice_number","name","address","arrival_date","departure_date","room_no","room_type","adults","rate_allocated","company_account_no","receptionist","map","line","i","date","description","voucher","toFixed","href","process","REACT_APP_API_BASE_URL","target","rel"],"sourceRoot":""}