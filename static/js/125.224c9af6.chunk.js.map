{"version":3,"file":"static/js/125.224c9af6.chunk.js","mappings":"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","sources":["pages/Invoice/InvoiceList.jsx","pages/Invoice/StaffInvoice.jsx","pages/Invoice/Invoice.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n// üöÄ Importing the centralized API handler\r\nimport api from \"../../api/api\"; \r\nimport { useNavigate, Link } from \"react-router-dom\"; // Import Link for navigation\r\nimport \"./InvoiceList.css\"; \r\n\r\n// --- Helper: Format Dates ---\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return \"N/A\";\r\n    try {\r\n        // Use Date object for consistent formatting, then strip time for YYYY-MM-DD\r\n        return new Date(dateString).toISOString().split('T')[0];\r\n    } catch (e) {\r\n        return dateString;\r\n    }\r\n};\r\n\r\n// üîπ ACCEPT 'onEdit' PROP FROM PARENT\r\nconst InvoiceList = ({ refreshTrigger = 0, onEdit }) => {\r\n    const navigate = useNavigate();\r\n    // Use an array to store combined invoices\r\n    const [invoices, setInvoices] = useState([]); \r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    // üõë Retrieve tokens from sessionStorage\r\n    const access = sessionStorage.getItem(\"access\");\r\n    \r\n    // --- Helper: Get Base URL for PDF Links ---\r\n    // Use window.location.origin as a fallback if BASE_URL is not reliable\r\n    const BASE_API_URL = `${window.location.origin}/api/v1`; \r\n\r\n    // --- Fetch ALL invoices from API ---\r\n    const fetchInvoices = async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        if (!access) {\r\n            navigate(\"/login\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // 1. Fetch Guest Invoices\r\n            const guestRes = api.get(\"/invoice/invoices/\");\r\n\r\n            // 2. Fetch Staff Invoices\r\n            const staffRes = api.get(\"/staff-invoice/invoices/\");\r\n\r\n            // Wait for both promises to resolve\r\n            const [guestData, staffData] = await Promise.all([guestRes, staffRes]);\r\n            \r\n            // 3. Normalize Guest Invoices\r\n            const guestInvoices = (guestData.data || []).map(inv => ({\r\n                ...inv,\r\n                type: 'Guest',\r\n                // Map API fields to common display fields\r\n                invoice_number: inv.invoice_number,\r\n                name: inv.name || inv.company_account_no, \r\n                roomNo: inv.room_no || 'N/A',\r\n                arrival: formatDate(inv.arrival_date),\r\n                departure: formatDate(inv.departure_date),\r\n                created_at: inv.created_at || new Date().toISOString(), // Fallback for sorting\r\n            }));\r\n\r\n            // 4. Normalize Staff Invoices\r\n            const staffInvoices = (staffData.data || []).map(inv => ({\r\n                ...inv,\r\n                type: 'Staff',\r\n                // Map staff-specific fields to common display fields\r\n                invoice_number: inv.invoice_number,\r\n                name: inv.staff_name || 'Staff Account', // Use staff_name\r\n                roomNo: 'Staff', // Specific label for display\r\n                arrival: 'N/A', // Staff invoices don't have this\r\n                departure: 'N/A', // Staff invoices don't have this\r\n                created_at: inv.created_at, // Use created_at for sorting\r\n            }));\r\n\r\n            // 5. Combine, Sort (Latest first), and Limit (Optional: slice(0, 20))\r\n            const combinedInvoices = [...guestInvoices, ...staffInvoices]\r\n                .sort((a, b) => new Date(b.created_at) - new Date(a.created_at));\r\n                // If you want to limit to 20 recent, add .slice(0, 20) here\r\n            \r\n            setInvoices(combinedInvoices);\r\n\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch invoices:\", err.response?.data || err.message);\r\n            setError(\"Failed to load invoice data. Check API status.\");\r\n            setInvoices([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // --- Load invoices on mount or refresh trigger ---\r\n    useEffect(() => {\r\n        fetchInvoices();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [refreshTrigger]);\r\n\r\n    // --- UI ---\r\n    if (loading) return <p className=\"loading-text\">Loading invoices...</p>;\r\n    if (error) return <p className=\"error-text\">Error: {error}</p>;\r\n\r\n    return (\r\n        <div className=\"invoice-list-container\">\r\n            <div className=\"list-header\">\r\n                <h2>Recent Invoices</h2>\r\n            </div>\r\n            \r\n            {invoices.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <p>No invoices found.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"table-wrapper\">\r\n                    <table className=\"invoice-list-table\">\r\n                        <thead>\r\n                            <tr>\r\n                                {/* üåü New Column: Type */}\r\n                                <th style={{width: '8%'}}>Type</th> \r\n                                <th style={{width: '10%'}}>Invoice No</th>\r\n                                <th style={{width: '25%'}}>Name / Account</th>\r\n                                <th style={{width: '8%'}}>Room No</th>\r\n                                <th style={{width: '12%'}}>Arrival</th>\r\n                                <th style={{width: '12%'}}>Departure</th>\r\n                                <th style={{width: '10%'}}>Receptionist</th>\r\n                                <th className=\"action-col\" style={{width: '15%'}}>Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {invoices.map((inv) => {\r\n                                // Determine the base API path for PDF/Detail links\r\n                                const apiPath = inv.type === 'Staff' ? 'staff-invoice' : 'invoice';\r\n\r\n                                return (\r\n                                    <tr\r\n                                        key={`${inv.type}-${inv.id}`}\r\n                                        className={`clickable-row ${inv.type.toLowerCase()}-row`}\r\n                                        // Optional: Navigate to a detailed view if you have one\r\n                                        // onClick={() => navigate(`/${apiPath}/${inv.id}`)}\r\n                                    >\r\n                                        {/* üåü Type Column */}\r\n                                        <td className={`type-tag type-${inv.type.toLowerCase()}`}>{inv.type}</td>\r\n                                        \r\n                                        <td className=\"highlight-text\">{inv.invoice_number}</td>\r\n                                        <td>{inv.name}</td>\r\n                                        <td><span className=\"room-badge\">{inv.roomNo}</span></td>\r\n                                        <td>{inv.arrival}</td>\r\n                                        <td>{inv.departure}</td>\r\n                                        <td>{inv.receptionist}</td>\r\n                                        \r\n                                        <td className=\"action-col\">\r\n                                            {/* üîπ EDIT BUTTON (Only for Guest Invoices) */}\r\n                                            {inv.type === 'Guest' && (\r\n                                                <button \r\n                                                    onClick={(e) => { e.stopPropagation(); onEdit(inv); }}\r\n                                                    style={{\r\n                                                        marginRight: '8px', \r\n                                                        background: 'transparent', \r\n                                                        border: '1px solid #ffb547', \r\n                                                        color: '#ffb547', \r\n                                                        cursor: 'pointer', \r\n                                                        padding: '4px 8px',\r\n                                                        borderRadius: '4px',\r\n                                                        fontSize: '0.8rem'\r\n                                                    }}\r\n                                                >\r\n                                                    Edit\r\n                                                </button>\r\n                                            )}\r\n                                            \r\n                                            {/* üîπ PDF Link (Uses correct API path based on type) */}\r\n                                            <a\r\n                                                href={`${BASE_API_URL}/${apiPath}/invoices/${inv.id}/pdf/`}\r\n                                                onClick={(e) => e.stopPropagation()}\r\n                                                target=\"_blank\"\r\n                                                rel=\"noreferrer\"\r\n                                                className=\"pdf-link\"\r\n                                            >\r\n                                                PDF\r\n                                            </a>\r\n                                        </td>\r\n                                    </tr>\r\n                                );\r\n                            })}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InvoiceList;","import React, { useState } from \"react\";\r\nimport api from \"../../api/api\";\r\nimport \"./StaffInvoice.css\";\r\n\r\nconst StaffInvoice = ({ onClose, onSuccess }) => {\r\n  const [header, setHeader] = useState({\r\n    staffName: \"\",\r\n    staffId: \"\",\r\n    department: \"\",\r\n    receptionist: \"Reception\",\r\n    invoiceNo: \"\",\r\n  });\r\n\r\n  const [lines, setLines] = useState([\r\n    { \r\n      date: new Date().toISOString().split(\"T\")[0], \r\n      category: \"Food\", \r\n      description: \"\", \r\n      amount: 0 \r\n    }\r\n  ]);\r\n\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Maps Invoice categories to the specific fields in LedgerRow model\r\n  const categoryMap = {\r\n    \"Food\": \"food\",\r\n    \"Bar\": \"bar\",\r\n    \"Laundry\": \"laundry\",\r\n    \"Pool\": \"swimming\",\r\n    \"Room\": \"room_hire\",\r\n    \"Other\": \"other\"\r\n  };\r\n\r\n  const handleHeaderChange = (e) => {\r\n    setHeader({ ...header, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleLineChange = (index, field, value) => {\r\n    const newLines = [...lines];\r\n    newLines[index][field] = value;\r\n    setLines(newLines);\r\n  };\r\n\r\n  const addLine = () => {\r\n    setLines([...lines, { \r\n      date: new Date().toISOString().split(\"T\")[0], \r\n      category: \"Food\", \r\n      description: \"\", \r\n      amount: 0 \r\n    }]);\r\n  };\r\n\r\n  const removeLine = (index) => {\r\n    if (lines.length > 1) {\r\n      setLines(lines.filter((_, i) => i !== index));\r\n    }\r\n  };\r\n\r\n  const total = lines.reduce((sum, line) => sum + parseFloat(line.amount || 0), 0);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!header.staffName) {\r\n      alert(\"Please fill in the Staff Name\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // 1. Save to Staff Invoice Tables\r\n      const invRes = await api.post(\"/staff-invoice/invoices/\", {\r\n        staff_name: header.staffName,\r\n        staff_id: header.staffId,\r\n        department: header.department,\r\n        receptionist: header.receptionist,\r\n        invoice_number: header.invoiceNo,\r\n      });\r\n\r\n      const invoiceId = invRes.data.id;\r\n\r\n      // 2. Aggregate category totals & save lines\r\n      const currentInvoiceTotals = {};\r\n      await Promise.all(lines.map(line => {\r\n        const col = categoryMap[line.category] || \"other\";\r\n        currentInvoiceTotals[col] = (currentInvoiceTotals[col] || 0) + parseFloat(line.amount || 0);\r\n\r\n        return api.post(\"/staff-invoice/lines/\", {\r\n          invoice: invoiceId,\r\n          date: line.date,\r\n          category: line.category,\r\n          description: line.description,\r\n          amount: line.amount\r\n        });\r\n      }));\r\n\r\n      // 3. SYNC TO LEDGER (Avoid Duplicates)\r\n      const today = new Date().toISOString().split(\"T\")[0];\r\n      const ledgerCheck = await api.get(`/ledger/?guestname=${encodeURIComponent(header.staffName)}&date=${today}`);\r\n\r\n      let ledgerPayload = {\r\n        date: today,\r\n        folio: \"STAFF\",\r\n        guest_name: header.staffName,\r\n        ...currentInvoiceTotals\r\n      };\r\n\r\n      if (ledgerCheck.data.length > 0) {\r\n        // UPDATE Existing Row\r\n        const existingRow = ledgerCheck.data[0];\r\n        \r\n        // Add new amounts to existing category amounts\r\n        Object.keys(currentInvoiceTotals).forEach(key => {\r\n          ledgerPayload[key] = parseFloat(existingRow[key] || 0) + currentInvoiceTotals[key];\r\n        });\r\n\r\n        const updatePayload = { ...existingRow, ...ledgerPayload };\r\n        await api.put(`/ledger/${existingRow.id}/`, updatePayload);\r\n      } else {\r\n        // CREATE New Row\r\n        await api.post(\"/ledger/\", ledgerPayload);\r\n      }\r\n\r\n      alert(\"Staff Invoice processed and Ledger updated!\");\r\n      if (onSuccess) onSuccess();\r\n      onClose();\r\n    } catch (err) {\r\n      console.error(\"Sync Error:\", err);\r\n      alert(\"Error syncing data. Ensure staff name matches ledger exactly.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fullscreen-modal glass-bg\">\r\n      <div className=\"staff-modal-content\">\r\n        <div className=\"staff-header\">\r\n          <h2>New Staff Invoice</h2>\r\n          <button className=\"row-remove\" style={{ fontSize: '24px' }} onClick={onClose}>√ó</button>\r\n        </div>\r\n\r\n        <div className=\"staff-input-section\">\r\n          <div className=\"staff-grid\">\r\n            <div className=\"staff-input-group\">\r\n              <label>Staff Name (Matches Ledger)</label>\r\n              <input name=\"staffName\" value={header.staffName} onChange={handleHeaderChange} placeholder=\"e.g. PAUL LUNA\" />\r\n            </div>\r\n            <div className=\"staff-input-group\">\r\n              <label>Staff ID</label>\r\n              <input name=\"staffId\" value={header.staffId} onChange={handleHeaderChange} placeholder=\"ID Number\" />\r\n            </div>\r\n            <div className=\"staff-input-group\">\r\n              <label>Department</label>\r\n              <input name=\"department\" value={header.department} onChange={handleHeaderChange} placeholder=\"e.g. Kitchen\" />\r\n            </div>\r\n            <div className=\"staff-input-group\">\r\n              <label>Invoice No</label>\r\n              <input name=\"invoiceNo\" value={header.invoiceNo} onChange={handleHeaderChange} placeholder=\"INV-001\" />\r\n            </div>\r\n            <div className=\"staff-input-group\">\r\n              <label>Receptionist</label>\r\n              <input name=\"receptionist\" value={header.receptionist} onChange={handleHeaderChange} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"staff-table-wrapper\">\r\n          <table className=\"staff-table\">\r\n            <thead>\r\n              <tr>\r\n                <th>Date</th>\r\n                <th>Category</th>\r\n                <th>Description</th>\r\n                <th>Amount ($)</th>\r\n                <th>Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {lines.map((line, i) => (\r\n                <tr key={i}>\r\n                  <td><input type=\"date\" value={line.date} onChange={(e) => handleLineChange(i, \"date\", e.target.value)} /></td>\r\n                  <td>\r\n                    <select value={line.category} onChange={(e) => handleLineChange(i, \"category\", e.target.value)}>\r\n                      {Object.keys(categoryMap).map(cat => (\r\n                        <option key={cat} value={cat}>{cat}</option>\r\n                      ))}\r\n                    </select>\r\n                  </td>\r\n                  <td><input value={line.description} onChange={(e) => handleLineChange(i, \"description\", e.target.value)} /></td>\r\n                  <td><input type=\"number\" value={line.amount} onChange={(e) => handleLineChange(i, \"amount\", e.target.value)} /></td>\r\n                  <td><button className=\"row-remove\" onClick={() => removeLine(i)}>√ó</button></td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n          <button className=\"add-row\" onClick={addLine}>+ Add Item</button>\r\n        </div>\r\n\r\n        <div className=\"staff-actions-footer\">\r\n          <div className=\"staff-total\">Total: <span>${total.toFixed(2)}</span></div>\r\n          <div>\r\n            <button className=\"cancel-btn\" onClick={onClose}>Cancel</button>\r\n            <button className=\"staff-btn-save\" onClick={handleSubmit} disabled={loading}>\r\n              {loading ? \"Processing...\" : \"Process Staff Invoice\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StaffInvoice;","import React, { useState, useEffect } from \"react\";\r\n// üöÄ Importing the centralized API handler\r\nimport api from \"../../api/api\"; \r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./Invoice.css\"; \r\nimport InvoiceList from \"./InvoiceList\";\r\n// üîπ IMPORT NEW COMPONENT (We assume StaffInvoice.jsx exists)\r\nimport StaffInvoiceDetail from \"./StaffInvoice\"; // Renamed to avoid confusion\r\n\r\nconst Invoice = () => {\r\n    const navigate = useNavigate();\r\n\r\n    // üîπ STATE: Initial Blank Invoice (Guest)\r\n    const initialInvoiceState = {\r\n        name: \"\", address: \"\", arrivalDate: \"\", departureDate: \"\", roomNo: \"\", roomType: \"\",\r\n        adults: 1, children: 0, rateAllocated: \"\", companyAccount: \"\", \r\n        receptionist: \"\", \r\n        vatNumber: \"10005237\", invoiceNo: \"\",\r\n    };\r\n\r\n    const [invoiceData, setInvoiceData] = useState(initialInvoiceState);\r\n    const [lines, setLines] = useState([{ date: \"\", description: \"\", voucher: \"\", charges: 0, credits: 0 }]);\r\n    \r\n    // üîπ STATE: UI Controls\r\n    const [showGuestModal, setShowGuestModal] = useState(false); // Renamed for clarity\r\n    const [showStaffModal, setShowStaffModal] = useState(false); \r\n    const [isEditing, setIsEditing] = useState(false); \r\n    const [editingId, setEditingId] = useState(null); ¬†\r\n    const [refreshListTrigger, setRefreshListTrigger] = useState(0); \r\n\r\n    const access = sessionStorage.getItem(\"access\"); \r\n    const isLoggedIn = !!access;\r\n\r\n    useEffect(() => {\r\n        if (!isLoggedIn) navigate(\"/login\");\r\n    }, [isLoggedIn, navigate]);\r\n\r\n    // --- HELPER: Get Current Logged In User ---\r\n    const getReceptionistName = () => {\r\n        try {\r\n            const userPayload = sessionStorage.getItem(\"user_payload\");\r\n            if (userPayload) {\r\n                const user = JSON.parse(userPayload);\r\n                return user.first_name || user.username || \"Reception\"; \r\n            }\r\n        } catch (e) {\r\n            console.error(\"Error parsing user payload\", e);\r\n        }\r\n        return \"Reception\";\r\n    };\r\n\r\n    // --- HANDLER: New Guest Invoice ---\r\n    const handleNewGuestInvoice = () => {\r\n        setIsEditing(false);\r\n        setEditingId(null);\r\n        setInvoiceData({ ...initialInvoiceState, receptionist: getReceptionistName() });\r\n        setLines([{ date: \"\", description: \"\", voucher: \"\", charges: 0, credits: 0 }]);\r\n        setShowGuestModal(true);\r\n    };\r\n\r\n    // üåü --- HANDLER: New Staff Invoice (Dedicated for Staff modal) ---\r\n    const handleNewStaffInvoice = () => {\r\n        // No need to set complex state here, as StaffInvoiceDetail will manage its own.\r\n        setShowStaffModal(true);\r\n    };\r\n\r\n    // --- HANDLER: Edit Guest Invoice ---\r\n    const handleEditInvoice = async (invoice) => {\r\n        // SECURITY CHECK: Ensure we only attempt to edit Guest invoices via this path\r\n        if (invoice.type !== 'Guest') {\r\n            alert(`Cannot edit ${invoice.type} invoice here. Use the appropriate workflow or log into the admin panel.`);\r\n            return;\r\n        }\r\n\r\n        setIsEditing(true);\r\n        setEditingId(invoice.id);\r\n        \r\n        setInvoiceData({\r\n            name: invoice.name,\r\n            address: invoice.address,\r\n            arrivalDate: invoice.arrival_date,\r\n            departureDate: invoice.departure_date,\r\n            roomNo: invoice.room_no,\r\n            roomType: invoice.room_type,\r\n            adults: invoice.adults,\r\n            children: invoice.children,\r\n            rateAllocated: invoice.rate_allocated,\r\n            companyAccount: invoice.company_account_no,\r\n            receptionist: getReceptionistName(), // Log the person making the EDIT\r\n            vatNumber: invoice.vat_number,\r\n            invoiceNo: invoice.invoice_number,\r\n        });\r\n\r\n        try {\r\n            // Fetch lines for the Guest Invoice\r\n            const res = await api.get(`/invoice/invoicelines/?invoice=${invoice.id}`);\r\n            setLines(res.data); \r\n        } catch (err) {\r\n            console.error(\"Failed to fetch lines\", err);\r\n            setLines([{ date: \"\", description: \"\", voucher: \"\", charges: 0, credits: 0 }]);\r\n        }\r\n\r\n        setShowGuestModal(true);\r\n    };\r\n\r\n    const handleChange = (e) => setInvoiceData({ ...invoiceData, [e.target.name]: e.target.value });\r\n\r\n    const handleLineChange = (index, field, value) => {\r\n        // SECURITY CHECK: If this line has an ID, it is historical. Do not allow edits.\r\n        if (lines[index].id) return;\r\n\r\n        const newLines = [...lines];\r\n        newLines[index][field] = value;\r\n        setLines(newLines);\r\n    };\r\n\r\n    const addRow = () => {\r\n        const today = new Date().toISOString().split('T')[0];\r\n        // New lines do NOT have an 'id', so they will be editable\r\n        setLines([...lines, { date: today, description: \"\", voucher: \"\", charges: 0, credits: 0 }]);\r\n    };\r\n\r\n    const removeRow = (index) => {\r\n        // SECURITY CHECK: Do not allow removing saved lines\r\n        if (lines[index].id) {\r\n            alert(\"You cannot remove past transactions.\");\r\n            return;\r\n        }\r\n        setLines(lines.filter((_, idx) => idx !== index));\r\n    };\r\n\r\n    const subtotal = lines.reduce((sum, l) => sum + (parseFloat(l.charges) || 0) - (parseFloat(l.credits) || 0), 0);\r\n    const vat = subtotal * 0.15;\r\n    const total = subtotal + vat;\r\n\r\n    // --- SUBMIT LOGIC (Guest Invoice) ---\r\n    const handleSubmit = async () => {\r\n        if (!window.confirm(isEditing ? \"Confirm update? Past data is locked.\" : \"Create this invoice?\")) return;\r\n\r\n        try {\r\n            const invoicePayload = {\r\n                name: invoiceData.name,\r\n                address: invoiceData.address,\r\n                arrival_date: invoiceData.arrivalDate,\r\n                departure_date: invoiceData.departureDate,\r\n                room_no: invoiceData.roomNo,\r\n                room_type: invoiceData.roomType,\r\n                adults: invoiceData.adults,\r\n                children: invoiceData.children,\r\n                rate_allocated: invoiceData.rateAllocated,\r\n                company_account_no: invoiceData.companyAccount,\r\n                receptionist: invoiceData.receptionist,\r\n                vat_number: invoiceData.vatNumber,\r\n                invoice_number: invoiceData.invoiceNo,\r\n            };\r\n\r\n            let activeInvoiceId = editingId;\r\n\r\n            if (isEditing) {\r\n                // In Edit mode, we PATCH (Update) the invoice header (mainly for Departure Date)\r\n                await api.patch(`/invoice/invoices/${editingId}/`, invoicePayload);\r\n            } else {\r\n                const res = await api.post(\"/invoice/invoices/\", invoicePayload);\r\n                activeInvoiceId = res.data.id;\r\n            }\r\n\r\n            // Handle Lines\r\n            await Promise.all(\r\n                lines.map((l) => {\r\n                    // IF line has ID, it's old. We SKIP it to prevent tampering.\r\n                    if (l.id) return Promise.resolve(); \r\n\r\n                    // IF line has NO ID, it is new. CREATE it.\r\n                    return api.post(\"/invoice/invoicelines/\", {\r\n                        invoice: activeInvoiceId,\r\n                        date: l.date,\r\n                        description: l.description,\r\n                        voucher: l.voucher,\r\n                        charges: l.charges,\r\n                        credits: l.credits,\r\n                    });\r\n                })\r\n            );\r\n\r\n            setRefreshListTrigger((s) => s + 1);\r\n            setShowGuestModal(false); // Close Guest Modal\r\n            alert(\"Saved Successfully!\");\r\n\r\n        } catch (err) {\r\n            console.error(\"Error:\", err.response?.data || err.message);\r\n            alert(\"Error saving invoice.\");\r\n        }\r\n    };\r\n\r\n    // Helper style for locked fields\r\n    const lockedStyle = { backgroundColor: '#1a2230', color: '#666', border: '1px solid #333', cursor: 'not-allowed' };\r\n\r\n    return (\r\n        <div className=\"invoice-page\">\r\n            \r\n            {/* üîπ MAIN LIST VIEW (Hidden if ANY modal is open) */}\r\n            {!showGuestModal && !showStaffModal && (\r\n                <>\r\n                    {/* BUTTON CONTAINER */}\r\n                    <div style={{ display: 'flex', gap: '15px', marginBottom: '20px' }}>\r\n                        <button className=\"new-invoice-btn\" onClick={handleNewGuestInvoice}>\r\n                            + New Guest Invoice\r\n                        </button>\r\n                        \r\n                        {/* NEW STAFF BUTTON (Now calls dedicated handler) */}\r\n                        <button \r\n                            className=\"new-invoice-btn\" \r\n                            style={{ backgroundColor: \"#47b5ff\", color: \"#000\", fontWeight: 'bold' }} \r\n                            onClick={handleNewStaffInvoice} // üåü UPDATED HANDLER\r\n                        >\r\n                            + New Staff Invoice\r\n                        </button>\r\n                    </div>\r\n\r\n                    <InvoiceList refreshTrigger={refreshListTrigger} onEdit={handleEditInvoice} />\r\n                </>\r\n            )}\r\n\r\n            {/* üîπ GUEST INVOICE MODAL (showModal renamed to showGuestModal) */}\r\n            {showGuestModal && (\r\n                <div className=\"fullscreen-modal glass-bg\">\r\n                    <button className=\"back-floating-center\" onClick={() => setShowGuestModal(false)}>‚Üê Cancel & Close</button>\r\n                    <div className=\"modal-fixed\">\r\n                        <div className=\"modal-content-fixed\">\r\n                            \r\n                            <header className=\"invoice-header\">\r\n                                <div className=\"header-brand\">\r\n                                    <h1>The Pumpkin Hotel (Pvt) Ltd</h1>\r\n                                    <p style={{color: isEditing ? '#ffb547' : '#888'}}>\r\n                                        {isEditing ? \"EDIT MODE (Restricted)\" : \"NEW GUEST INVOICE\"}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"invoice-meta\">\r\n                                    <label>TAX INVOICE No:</label>\r\n                                    <input className=\"invoiceNo\" value={invoiceData.invoiceNo} onChange={handleChange} name=\"invoiceNo\" readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                </div>\r\n                            </header>\r\n\r\n                            {/* Guest Details - LOCKED ON EDIT */}\r\n                            <section className=\"input-grid-section\">\r\n                                <h3>Guest Details</h3>\r\n                                <div className=\"guest-info\">\r\n                                    <div className=\"input-group full-width\">\r\n                                        <label>Name</label>\r\n                                        <input name=\"name\" value={invoiceData.name} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    <div className=\"input-group full-width\">\r\n                                        <label>Address</label>\r\n                                        <input name=\"address\" value={invoiceData.address} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                </div>\r\n                            </section>\r\n\r\n                            {/* Stay Details */}\r\n                            <section className=\"input-grid-section\">\r\n                                <h3>Stay Details</h3>\r\n                                <div className=\"stay-info\">\r\n                                    <div className=\"input-group\">\r\n                                        <label>Arrival Date</label>\r\n                                        <input name=\"arrivalDate\" type=\"date\" value={invoiceData.arrivalDate} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    \r\n                                    {/* üëá DEPARTURE DATE: Always Editable */}\r\n                                    <div className=\"input-group\" style={{border: '1px solid #ffb547', borderRadius: '4px'}}>\r\n                                        <label style={{color: '#ffb547'}}>Departure Date</label>\r\n                                        <input name=\"departureDate\" type=\"date\" value={invoiceData.departureDate} onChange={handleChange} />\r\n                                    </div>\r\n\r\n                                    <div className=\"input-group\">\r\n                                        <label>Room No</label>\r\n                                        <input name=\"roomNo\" value={invoiceData.roomNo} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    <div className=\"input-group\">\r\n                                        <label>Room Type</label>\r\n                                        <input name=\"roomType\" value={invoiceData.roomType} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    <div className=\"input-group\">\r\n                                        <label>Adults</label>\r\n                                        <input name=\"adults\" type=\"number\" value={invoiceData.adults} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    <div className=\"input-group\">\r\n                                        <label>Rate Allocated</label>\r\n                                        <input name=\"rateAllocated\" value={invoiceData.rateAllocated} onChange={handleChange} readOnly={isEditing} style={isEditing ? lockedStyle : {}} />\r\n                                    </div>\r\n                                    <div className=\"input-group\">\r\n                                        <label>Receptionist</label>\r\n                                        <input name=\"receptionist\" value={invoiceData.receptionist} readOnly style={lockedStyle} />\r\n                                    </div>\r\n                                </div>\r\n                            </section>\r\n\r\n                            {/* Line Items */}\r\n                            <div className=\"table-responsive\">\r\n                                <table className=\"invoice-table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th style={{width: '15%'}}>Date</th>\r\n                                            <th style={{width: '35%'}}>Description</th>\r\n                                            <th style={{width: '15%'}}>Voucher</th>\r\n                                            <th style={{width: '15%'}}>Charges ($)</th>\r\n                                            <th style={{width: '15%'}}>Credits ($)</th>\r\n                                            <th style={{width: '5%'}}></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {lines.map((l, i) => {\r\n                                            const isLocked = !!l.id; \r\n                                            const rowStyle = isLocked ? { backgroundColor: '#1a2230', color: '#666' } : {};\r\n\r\n                                            return (\r\n                                                <tr key={i} style={rowStyle}>\r\n                                                    <td>\r\n                                                        <input type=\"date\" value={l.date} onChange={(e) => handleLineChange(i, \"date\", e.target.value)} readOnly={isLocked} style={isLocked ? {border:'none', background:'transparent', color:'#888'} : {}} />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <input type=\"text\" value={l.description} onChange={(e) => handleLineChange(i, \"description\", e.target.value)} readOnly={isLocked} style={isLocked ? {border:'none', background:'transparent', color:'#888'} : {}} placeholder={isLocked ? \"\" : \"Description\"} />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <input type=\"text\" value={l.voucher} onChange={(e) => handleLineChange(i, \"voucher\", e.target.value)} readOnly={isLocked} style={isLocked ? {border:'none', background:'transparent', color:'#888'} : {}} />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <input type=\"number\" value={l.charges} onChange={(e) => handleLineChange(i, \"charges\", e.target.value)} readOnly={isLocked} style={isLocked ? {border:'none', background:'transparent', color:'#888'} : {}} />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <input type=\"number\" value={l.credits} onChange={(e) => handleLineChange(i, \"credits\", e.target.value)} readOnly={isLocked} style={isLocked ? {border:'none', background:'transparent', color:'#888'} : {}} />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        {!isLocked && <button className=\"row-remove\" onClick={() => removeRow(i)}>√ó</button>}\r\n                                                        {isLocked && <span style={{fontSize:'12px'}}>üîí</span>}\r\n                                                    </td>\r\n                                                </tr>\r\n                                            );\r\n                                        })}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                            <button onClick={addRow} className=\"add-row\">+ Add Line Item</button>\r\n\r\n                            <div className=\"footer-layout\">\r\n                                <div className=\"actions-left\">\r\n                                    <button className=\"cancel-btn\" onClick={() => setShowGuestModal(false)}>Cancel</button>\r\n                                    <button className=\"save-btn\" onClick={handleSubmit}>\r\n                                        {isEditing ? \"Update Invoice\" : \"Save Invoice\"}\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"totals\">\r\n                                    <div className=\"totals-row\"><span>Sub Total:</span> <span>${subtotal.toFixed(2)}</span></div>\r\n                                    <div className=\"totals-row\"><span>VAT (15%):</span> <span>${vat.toFixed(2)}</span></div>\r\n                                    <div className=\"totals-row grand-total\"><span>Total:</span> <span>${total.toFixed(2)}</span></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* üîπ NEW STAFF INVOICE MODAL */}\r\n            {showStaffModal && (\r\n                <StaffInvoiceDetail // üåü Renamed component for clarity\r\n                    onClose={() => setShowStaffModal(false)}\r\n                    onSuccess={() => {\r\n                        // Close modal, and trigger list refresh\r\n                        setShowStaffModal(false);\r\n                        setRefreshListTrigger(s => s + 1); \r\n                        alert(\"Staff Invoice Created Successfully!\");\r\n                    }}\r\n                />\r\n            )}\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Invoice;"],"names":["formatDate","dateString","Date","toISOString","split","e","_ref","refreshTrigger","onEdit","navigate","useNavigate","invoices","setInvoices","useState","loading","setLoading","error","setError","access","sessionStorage","getItem","BASE_API_URL","concat","window","location","origin","useEffect","async","guestRes","api","get","staffRes","guestData","staffData","Promise","all","guestInvoices","data","map","inv","_objectSpread","type","invoice_number","name","company_account_no","roomNo","room_no","arrival","arrival_date","departure","departure_date","created_at","staffInvoices","staff_name","combinedInvoices","sort","a","b","err","_err$response","console","response","message","fetchInvoices","_jsx","className","children","_jsxs","length","style","width","apiPath","toLowerCase","receptionist","onClick","stopPropagation","marginRight","background","border","color","cursor","padding","borderRadius","fontSize","href","id","target","rel","onClose","onSuccess","header","setHeader","staffName","staffId","department","invoiceNo","lines","setLines","date","category","description","amount","categoryMap","handleHeaderChange","value","handleLineChange","index","field","newLines","total","reduce","sum","line","parseFloat","onChange","placeholder","i","Object","keys","cat","removeLine","filter","_","addLine","toFixed","invoiceId","post","staff_id","currentInvoiceTotals","col","invoice","today","ledgerCheck","encodeURIComponent","ledgerPayload","folio","guest_name","existingRow","forEach","key","updatePayload","put","alert","disabled","Invoice","initialInvoiceState","address","arrivalDate","departureDate","roomType","adults","rateAllocated","companyAccount","vatNumber","invoiceData","setInvoiceData","voucher","charges","credits","showGuestModal","setShowGuestModal","showStaffModal","setShowStaffModal","isEditing","setIsEditing","editingId","setEditingId","refreshListTrigger","setRefreshListTrigger","isLoggedIn","getReceptionistName","userPayload","user","JSON","parse","first_name","username","handleChange","subtotal","l","vat","lockedStyle","backgroundColor","_Fragment","display","gap","marginBottom","handleNewGuestInvoice","fontWeight","handleNewStaffInvoice","InvoiceList","room_type","rate_allocated","vat_number","res","readOnly","isLocked","rowStyle","idx","addRow","confirm","invoicePayload","activeInvoiceId","patch","resolve","s","StaffInvoiceDetail"],"sourceRoot":""}