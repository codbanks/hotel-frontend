"use strict";(self.webpackChunkhotel_frontend=self.webpackChunkhotel_frontend||[]).push([[106],{106:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var r=s(555),a=s(43),c=s(475),d=s(505),n=s(579);const i=e=>new Date(e).toISOString().split("T")[0],l=e=>{const t=Number(String(e||0).replace(/[^0-9.-]+/g,""));return isNaN(t)?0:t};function h(){const[e,t]=(0,a.useState)(i(new Date)),[s,h]=(0,a.useState)(!0),[o,x]=(0,a.useState)({day:{},mtd:{}}),j=(e,t,s)=>{const a=new Date(s);a.setHours(0,0,0,0);const c={rooms_sold:t.filter(e=>{const t=new Date(e.arrival_date);t.setHours(0,0,0,0);const s=e.departure_date?new Date(e.departure_date):new Date(t);return e.departure_date||s.setDate(s.getDate()+1),s.setHours(0,0,0,0),a>=t&&a<s}).length,acc:0,food:0,bar:0,usd_swipe:0,ecocash_zig:0,t_charge:0};return e.forEach(e=>{c.acc+=l(e.acc),c.food+=l(e.food),c.bar+=l(e.bar),c.usd_swipe+=l(e.usd_swipe),c.ecocash_zig+=l(e.ecocash_zig),c.t_charge+=l(e.t_charge)}),(0,r.A)((0,r.A)({},c),{},{occ_pct:c.rooms_sold/58*100,arr:c.rooms_sold>0?c.acc/c.rooms_sold:0})};(0,a.useEffect)(()=>{(async()=>{h(!0);try{const t="".concat(e.substring(0,7),"-01"),[s,r,a]=await Promise.all([d.A.get("/ledger/?date=".concat(e)),d.A.get("/ledger/?start_date=".concat(t,"&end_date=").concat(e)),d.A.get("/invoices/")]);x({day:j(s.data||[],a.data||[],e),mtd:j(r.data||[],a.data||[],e)})}catch(t){console.error("Fetch Error:",t)}finally{h(!1)}})()},[e]);const m=e=>"$ ".concat(l(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}));return s?(0,n.jsx)("div",{className:"loading-screen",children:"Calculating Revenue Data..."}):(0,n.jsxs)("div",{className:"daily-revenue-wrapper",children:[(0,n.jsxs)("header",{className:"report-nav",children:[(0,n.jsx)(c.N_,{to:"/",className:"nav-back",children:"\u2190 DASHBOARD"}),(0,n.jsxs)("div",{className:"nav-main",children:[(0,n.jsx)("button",{className:"btn-orange",onClick:()=>{let s=new Date(e);s.setDate(s.getDate()-1),t(i(s))},children:"PREV"}),(0,n.jsxs)("div",{className:"nav-title",children:[(0,n.jsx)("h1",{children:"DAILY REVENUE REPORT"}),(0,n.jsxs)("span",{children:["DATE: ",e]})]}),(0,n.jsx)("button",{className:"btn-orange",onClick:()=>{let s=new Date(e);s.setDate(s.getDate()+1),t(i(s))},children:"NEXT"})]}),(0,n.jsx)("div",{className:"nav-stat",children:"CAPACITY: 58 ROOMS"})]}),(0,n.jsx)("div",{className:"report-scroll-area",children:(0,n.jsxs)("table",{className:"revenue-table",children:[(0,n.jsxs)("thead",{children:[(0,n.jsxs)("tr",{className:"head-row",children:[(0,n.jsx)("th",{rowSpan:"2",children:"REVENUE ITEM"}),(0,n.jsx)("th",{colSpan:"2",children:"DAILY ACTUAL"}),(0,n.jsx)("th",{colSpan:"2",children:"MONTH TO DATE"})]}),(0,n.jsxs)("tr",{className:"sub-head-row",children:[(0,n.jsx)("th",{children:"ACTUAL"}),(0,n.jsx)("th",{children:"VARIANCE"}),(0,n.jsx)("th",{children:"ACTUAL"}),(0,n.jsx)("th",{children:"VARIANCE"})]})]}),(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"ROOMS AVAILABLE"}),(0,n.jsx)("td",{className:"text-right",children:"58"}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:"58"}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"ROOMS SOLD"}),(0,n.jsx)("td",{className:"text-right",children:o.day.rooms_sold}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:o.mtd.rooms_sold}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"ROOM OCCUPANCY %"}),(0,n.jsxs)("td",{className:"text-right",children:[l(o.day.occ_pct).toFixed(1),"%"]}),(0,n.jsx)("td",{children:"-"}),(0,n.jsxs)("td",{className:"text-right",children:[l(o.mtd.occ_pct).toFixed(1),"%"]}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{className:"row-highlight",children:[(0,n.jsx)("td",{children:"ROOMS REVENUE (ACC)"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.acc)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.acc)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"AVERAGE ROOM RATE (ARR)"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.arr)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.arr)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"FOOD ACTUAL SALES"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.food)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.food)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"BAR ACTUAL REVENUE"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.bar)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.bar)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{className:"row-credit",children:[(0,n.jsx)("td",{children:"USD SWIPE (CREDIT)"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.usd_swipe)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.usd_swipe)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{className:"row-credit",children:[(0,n.jsx)("td",{children:"ECOCASH (CREDIT)"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.ecocash_zig)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.ecocash_zig)}),(0,n.jsx)("td",{children:"-"})]}),(0,n.jsxs)("tr",{className:"row-grand-total",children:[(0,n.jsx)("td",{children:"TOTAL HOTEL REVENUE"}),(0,n.jsx)("td",{className:"text-right",children:m(o.day.t_charge)}),(0,n.jsx)("td",{children:"-"}),(0,n.jsx)("td",{className:"text-right",children:m(o.mtd.t_charge)}),(0,n.jsx)("td",{children:"-"})]})]})]})})]})}},505:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(722);const a={NODE_ENV:"production",PUBLIC_URL:"/hotel-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://127.0.0.1:8000/api/v2",c=r.A.create({baseURL:a,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{const t=localStorage.getItem("access");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>e,async e=>{var t;const s=e.config;if(401===(null===(t=e.response)||void 0===t?void 0:t.status)&&!s._retry){s._retry=!0;const e=localStorage.getItem("refresh");if(e)try{const t=await r.A.post("".concat(a.replace("/v2","/v1"),"/token/refresh/"),{refresh:e});return localStorage.setItem("access",t.data.access),s.headers.Authorization="Bearer ".concat(t.data.access),c(s)}catch(d){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}else window.location.href="/login"}return Promise.reject(e)});const d=c}}]);
//# sourceMappingURL=106.3f1d2a4f.chunk.js.map