{"version":3,"file":"static/js/106.3f1d2a4f.chunk.js","mappings":"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","sources":["pages/reports/DailyRevenue.jsx","services/api.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport api from \"../../services/api\";\r\nimport \"../../styles/DailyRevenue.css\";\r\n\r\nconst isoDate = (d) => new Date(d).toISOString().split('T')[0];\r\n\r\nconst n = (v) => {\r\n    const num = Number(String(v || 0).replace(/[^0-9.-]+/g, \"\"));\r\n    return isNaN(num) ? 0 : num;\r\n};\r\n\r\nexport default function DailyRevenue() {\r\n    const [currentDate, setCurrentDate] = useState(isoDate(new Date()));\r\n    const [loading, setLoading] = useState(true);\r\n    const [report, setReport] = useState({ day: {}, mtd: {} });\r\n\r\n    const aggregateData = (ledgerRows, allInvoices, targetDateStr) => {\r\n        const capacity = 58;\r\n        const targetDate = new Date(targetDateStr);\r\n        targetDate.setHours(0, 0, 0, 0);\r\n\r\n        // 1. Calculate Rooms Sold (Occupancy Logic)\r\n        // A room is sold if: Arrival <= Target Date AND Departure > Target Date\r\n        const roomsSoldOnDate = allInvoices.filter(inv => {\r\n            const arr = new Date(inv.arrival_date);\r\n            arr.setHours(0, 0, 0, 0);\r\n            \r\n            // If no departure date, assume 1 night stay\r\n            const dep = inv.departure_date ? new Date(inv.departure_date) : new Date(arr);\r\n            if (!inv.departure_date) dep.setDate(dep.getDate() + 1);\r\n            dep.setHours(0, 0, 0, 0);\r\n\r\n            return targetDate >= arr && targetDate < dep;\r\n        }).length;\r\n\r\n        // 2. Sum Revenue from Ledger Rows\r\n        const sums = {\r\n            rooms_sold: roomsSoldOnDate,\r\n            acc: 0, food: 0, bar: 0,\r\n            usd_swipe: 0, ecocash_zig: 0, t_charge: 0\r\n        };\r\n\r\n        ledgerRows.forEach(r => {\r\n            sums.acc += n(r.acc);\r\n            sums.food += n(r.food);\r\n            sums.bar += n(r.bar);\r\n            sums.usd_swipe += n(r.usd_swipe);\r\n            sums.ecocash_zig += n(r.ecocash_zig);\r\n            sums.t_charge += n(r.t_charge);\r\n        });\r\n\r\n        return {\r\n            ...sums,\r\n            occ_pct: (sums.rooms_sold / capacity) * 100,\r\n            arr: sums.rooms_sold > 0 ? (sums.acc / sums.rooms_sold) : 0,\r\n        };\r\n    };\r\n\r\n    useEffect(() => {\r\n        const loadReport = async () => {\r\n            setLoading(true);\r\n            try {\r\n                const startOfMonth = `${currentDate.substring(0, 7)}-01`;\r\n                \r\n                // Fetch Ledger for money, Invoices for occupancy stay-durations\r\n                const [resDay, resMtd, resInvoices] = await Promise.all([\r\n                    api.get(`/ledger/?date=${currentDate}`),\r\n                    api.get(`/ledger/?start_date=${startOfMonth}&end_date=${currentDate}`),\r\n                    api.get(`/invoices/`) \r\n                ]);\r\n\r\n                setReport({\r\n                    day: aggregateData(resDay.data || [], resInvoices.data || [], currentDate),\r\n                    mtd: aggregateData(resMtd.data || [], resInvoices.data || [], currentDate)\r\n                });\r\n            } catch (err) {\r\n                console.error(\"Fetch Error:\", err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        loadReport();\r\n    }, [currentDate]);\r\n\r\n    const renderMoney = (val) => `$ ${n(val).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n\r\n    if (loading) return <div className=\"loading-screen\">Calculating Revenue Data...</div>;\r\n\r\n    return (\r\n        <div className=\"daily-revenue-wrapper\">\r\n            <header className=\"report-nav\">\r\n                <Link to=\"/\" className=\"nav-back\">‚Üê DASHBOARD</Link>\r\n                <div className=\"nav-main\">\r\n                    <button className=\"btn-orange\" onClick={() => {\r\n                        let d = new Date(currentDate); d.setDate(d.getDate() - 1); setCurrentDate(isoDate(d));\r\n                    }}>PREV</button>\r\n                    <div className=\"nav-title\">\r\n                        <h1>DAILY REVENUE REPORT</h1>\r\n                        <span>DATE: {currentDate}</span>\r\n                    </div>\r\n                    <button className=\"btn-orange\" onClick={() => {\r\n                        let d = new Date(currentDate); d.setDate(d.getDate() + 1); setCurrentDate(isoDate(d));\r\n                    }}>NEXT</button>\r\n                </div>\r\n                <div className=\"nav-stat\">CAPACITY: 58 ROOMS</div>\r\n            </header>\r\n\r\n            <div className=\"report-scroll-area\">\r\n                <table className=\"revenue-table\">\r\n                    <thead>\r\n                        <tr className=\"head-row\">\r\n                            <th rowSpan=\"2\">REVENUE ITEM</th>\r\n                            <th colSpan=\"2\">DAILY ACTUAL</th>\r\n                            <th colSpan=\"2\">MONTH TO DATE</th>\r\n                        </tr>\r\n                        <tr className=\"sub-head-row\">\r\n                            <th>ACTUAL</th><th>VARIANCE</th>\r\n                            <th>ACTUAL</th><th>VARIANCE</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>ROOMS AVAILABLE</td>\r\n                            <td className=\"text-right\">58</td><td>-</td>\r\n                            <td className=\"text-right\">58</td><td>-</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>ROOMS SOLD</td>\r\n                            <td className=\"text-right\">{report.day.rooms_sold}</td><td>-</td>\r\n                            <td className=\"text-right\">{report.mtd.rooms_sold}</td><td>-</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>ROOM OCCUPANCY %</td>\r\n                            <td className=\"text-right\">{n(report.day.occ_pct).toFixed(1)}%</td><td>-</td>\r\n                            <td className=\"text-right\">{n(report.mtd.occ_pct).toFixed(1)}%</td><td>-</td>\r\n                        </tr>\r\n                        <tr className=\"row-highlight\">\r\n                            <td>ROOMS REVENUE (ACC)</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.acc)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.acc)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>AVERAGE ROOM RATE (ARR)</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.arr)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.arr)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>FOOD ACTUAL SALES</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.food)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.food)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>BAR ACTUAL REVENUE</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.bar)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.bar)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr className=\"row-credit\">\r\n                            <td>USD SWIPE (CREDIT)</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.usd_swipe)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.usd_swipe)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr className=\"row-credit\">\r\n                            <td>ECOCASH (CREDIT)</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.ecocash_zig)}</td><td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.ecocash_zig)}</td><td>-</td>\r\n                        </tr>\r\n                        <tr className=\"row-grand-total\">\r\n                            <td>TOTAL HOTEL REVENUE</td>\r\n                            <td className=\"text-right\">{renderMoney(report.day.t_charge)}</td>\r\n                            <td>-</td>\r\n                            <td className=\"text-right\">{renderMoney(report.mtd.t_charge)}</td>\r\n                            <td>-</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}","// src/services/api.js\r\nimport axios from 'axios';\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://127.0.0.1:8000/api/v2';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE,\r\n  headers: { 'Content-Type': 'application/json' },\r\n});\r\n\r\n// Attach latest access token before every request\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('access');\r\n    if (token) config.headers.Authorization = `Bearer ${token}`;\r\n    return config;\r\n  },\r\n  (error) => Promise.reject(error)\r\n);\r\n\r\n// Handle 401 and automatically refresh token\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  async (error) => {\r\n    const originalRequest = error.config;\r\n\r\n    if (error.response?.status === 401 && !originalRequest._retry) {\r\n      originalRequest._retry = true;\r\n      const refreshToken = localStorage.getItem('refresh');\r\n\r\n      if (refreshToken) {\r\n        try {\r\n          const res = await axios.post(`${API_BASE.replace('/v2', '/v1')}/token/refresh/`, {\r\n            refresh: refreshToken,\r\n          });\r\n\r\n          // Save new access token\r\n          localStorage.setItem('access', res.data.access);\r\n          originalRequest.headers.Authorization = `Bearer ${res.data.access}`;\r\n\r\n          // Retry original request\r\n          return api(originalRequest);\r\n        } catch (err) {\r\n          localStorage.removeItem('access');\r\n          localStorage.removeItem('refresh');\r\n          window.location.href = '/login'; // Redirect to login if refresh fails\r\n        }\r\n      } else {\r\n        window.location.href = '/login'; // No refresh token, force login\r\n      }\r\n    }\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"names":["isoDate","d","Date","toISOString","split","n","v","num","Number","String","replace","isNaN","DailyRevenue","currentDate","setCurrentDate","useState","loading","setLoading","report","setReport","day","mtd","aggregateData","ledgerRows","allInvoices","targetDateStr","targetDate","setHours","sums","rooms_sold","filter","inv","arr","arrival_date","dep","departure_date","setDate","getDate","length","acc","food","bar","usd_swipe","ecocash_zig","t_charge","forEach","r","_objectSpread","occ_pct","useEffect","async","startOfMonth","concat","substring","resDay","resMtd","resInvoices","Promise","all","api","get","data","err","console","error","loadReport","renderMoney","val","toLocaleString","undefined","minimumFractionDigits","maximumFractionDigits","_jsx","className","children","_jsxs","Link","to","onClick","rowSpan","colSpan","toFixed","API_BASE","process","REACT_APP_API_BASE","axios","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","reject","response","_error$response","originalRequest","status","_retry","refreshToken","res","post","refresh","setItem","access","removeItem","window","location","href"],"sourceRoot":""}