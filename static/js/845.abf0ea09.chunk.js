"use strict";(self.webpackChunkhotel_frontend=self.webpackChunkhotel_frontend||[]).push([[845],{845:(s,e,t)=>{t.r(e),t.d(e,{default:()=>r});var a=t(555),l=t(43),c=t(931),n=t(579);const d=s=>"number"!==typeof s?"-":"$ ".concat(s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),r=()=>{const[s,e]=(0,l.useState)((new Date).toISOString().split("T")[0]),[t,r]=(0,l.useState)([]),[i,o]=(0,l.useState)([]),[h,m]=(0,l.useState)(!1),x=(0,l.useCallback)(async()=>{m(!0);try{const[s,e]=await Promise.all([c.A.get("/staff-invoice/invoices/"),c.A.get("/staff-invoice/lines/")]);r(s.data),o(e.data)}catch(s){console.error("Failed to load staff records:",s)}finally{m(!1)}},[]);(0,l.useEffect)(()=>{x()},[x]);const u=t=>{const a=new Date(s);a.setDate(a.getDate()+t),e(a.toISOString().split("T")[0])},{processedData:j,totals:f}=(0,l.useMemo)(()=>{const e=new Date(s);e.setDate(1);const l=e.toISOString().split("T")[0];let c=0,n=0,d=0,r=0;const o={};t.forEach(e=>{const t=e.staff_name;o[t]||(o[t]={name:t,d_sales:0,d_disc:0,m_sales:0});i.filter(s=>s.invoice===e.id).forEach(e=>{const a=parseFloat(e.amount||0);e.date===s&&(o[t].d_sales+=a),e.date>=l&&e.date<=s&&(o[t].m_sales+=a)})});return{processedData:Object.values(o).map(s=>{const e=s.d_sales-s.d_disc;return c+=s.d_sales,n+=s.d_disc,d+=e,r+=s.m_sales,(0,a.A)((0,a.A)({},s),{},{d_total:e})}),totals:{d_sales:c,d_disc:n,d_total:d,m_sales:r}}},[t,i,s]);return(0,n.jsxs)("div",{className:"debtors-container",children:[(0,n.jsxs)("header",{className:"debtors-header",children:[(0,n.jsxs)("div",{className:"header-info",children:[(0,n.jsx)("h3",{children:"Staff Debtors Report"}),(0,n.jsx)("span",{className:"date-tag",children:s})]}),(0,n.jsxs)("div",{className:"report-controls",children:[(0,n.jsx)("button",{className:"nav-btn",onClick:()=>u(-1),children:"\u25c0 Previous Date"}),(0,n.jsx)("button",{className:"nav-btn",onClick:()=>u(1),children:"Next Date \u25b6"}),(0,n.jsx)("button",{className:"refresh-btn",onClick:x,children:"\u21bb Refresh"})]})]}),(0,n.jsx)("div",{className:"table-responsive",children:(0,n.jsxs)("table",{className:"debtors-table",children:[(0,n.jsxs)("thead",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{rowSpan:"2",className:"text-left",children:"Name"}),(0,n.jsxs)("th",{colSpan:"3",className:"group-head",children:[s," (Actual)"]}),(0,n.jsx)("th",{className:"group-head",children:"Month To Date"})]}),(0,n.jsxs)("tr",{className:"sub-head",children:[(0,n.jsx)("th",{children:"Sales Actual"}),(0,n.jsx)("th",{children:"Discount Amt"}),(0,n.jsx)("th",{children:"Total"}),(0,n.jsx)("th",{children:"Sales Actual"})]})]}),(0,n.jsx)("tbody",{children:h?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:"5",className:"status-cell",children:"Updating report records..."})}):j.length>0?j.map((s,e)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"text-left name-col",children:s.name}),(0,n.jsx)("td",{className:"numeric",children:0===s.d_sales?"-":d(s.d_sales)}),(0,n.jsx)("td",{className:"numeric",children:0===s.d_disc?"-":d(s.d_disc)}),(0,n.jsx)("td",{className:"numeric bold-col",children:0===s.d_total?"-":d(s.d_total)}),(0,n.jsx)("td",{className:"numeric",children:d(s.m_sales)})]},e)):(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:"5",className:"status-cell",children:"No transactions found for this date."})})}),(0,n.jsx)("tfoot",{children:(0,n.jsxs)("tr",{className:"grand-total",children:[(0,n.jsx)("td",{className:"text-left",children:"TOTAL"}),(0,n.jsx)("td",{className:"numeric",children:d(f.d_sales)}),(0,n.jsx)("td",{className:"numeric",children:d(f.d_disc)}),(0,n.jsx)("td",{className:"numeric",children:d(f.d_total)}),(0,n.jsx)("td",{className:"numeric highlight",children:d(f.m_sales)})]})})]})})]})}}}]);
//# sourceMappingURL=845.abf0ea09.chunk.js.map