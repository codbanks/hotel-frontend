"use strict";(self.webpackChunkhotel_frontend=self.webpackChunkhotel_frontend||[]).push([[788],{505:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(722);const r={NODE_ENV:"production",PUBLIC_URL:"/hotel-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://127.0.0.1:8000/api/v2",a=o.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{const t=localStorage.getItem("access");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var t;const n=e.config;if(401===(null===(t=e.response)||void 0===t?void 0:t.status)&&!n._retry){n._retry=!0;const e=localStorage.getItem("refresh");if(e)try{const t=await o.A.post("".concat(r.replace("/v2","/v1"),"/token/refresh/"),{refresh:e});return localStorage.setItem("access",t.data.access),n.headers.Authorization="Bearer ".concat(t.data.access),a(n)}catch(s){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}else window.location.href="/login"}return Promise.reject(e)});const s=a},788:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(555),r=n(43),a=n(505),s=n(579);const i=Array.from({length:58},(e,t)=>({room_number:t+1,room_type:{1:"Double",2:"Double",3:"Double",4:"Twin",5:"Twin",6:"Twin",7:"Twin",8:"Twin",9:"Twin",10:"Twin",11:"Twin",12:"Twin",13:"Twin",14:"Twin",15:"Twin",16:"Twin",17:"Twin",18:"Twin",19:"Twin",20:"Twin",21:"Twin",22:"Twin",23:"Twin",24:"Twin",25:"Double",26:"Double",27:"Twin",28:"Twin",29:"Twin",30:"Double",31:"Twin",32:"Twin",33:"Twin",34:"Twin",35:"Double",36:"Double",37:"Twin",38:"Twin",39:"Suite",40:"Suite",41:"Double",42:"Double",43:"Double",44:"Double",45:"Double",46:"Double",47:"Double",48:"Twin",49:"Double",50:"Double",51:"Single",52:"Single",53:"Single",54:"Twin",55:"Twin",56:"Twin",57:"Twin",58:"Single"}[t+1],guest_name:"",pax:"",organization:"",check_in:"",check_out:"",requirements:"",time:"",rate:"",out_of_order:!1})),c=e=>new Date(e).toISOString().split("T")[0],l=e=>{const t=new Date(e);return t.setDate(t.getDate()+1),c(t)},u=e=>{const t=new Date(e);return t.setDate(t.getDate()-1),c(t)};function d(){const e=c(new Date),[t,n]=(0,r.useState)(e),[d,h]=(0,r.useState)([]),[m,x]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[j,_]=(0,r.useState)(null),[w,v]=(0,r.useState)("all"),[T,b]=(0,r.useState)("true"===localStorage.getItem("house-darkmode")),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{S()},[t]),(0,r.useEffect)(()=>{document.body.className=T?"dark-mode":"",localStorage.setItem("house-darkmode",T)},[T]);const S=async()=>{x(!0);try{const e=(await a.A.get("/house_status_report/house-status/")).data,n=i.map(e=>(0,o.A)({},e)),r=new Date(t);e.forEach(e=>{const t=new Date(e.check_in),a=new Date(e.check_out);if(r>=t&&r<=a){const t=n.findIndex(t=>t.room_number===parseInt(e.room_number));-1!==t&&(n[t]=(0,o.A)((0,o.A)({},n[t]),{},{guest_name:e.guest_name,organization:e.organization,pax:e.pax,check_in:e.check_in,check_out:e.check_out,rate:e.rate,out_of_order:e.out_of_order,time:e.time}))}}),h(n)}catch(e){console.error("Fetch error:",e),h(i)}finally{x(!1)}},k=(e,t,n)=>{const o=[...d];o[e][t]=n,h(o)},D=d.filter(e=>"occupied"===w?""!==e.guest_name.trim():"unoccupied"===w?""===e.guest_name.trim():"outoforder"!==w||e.out_of_order);return(0,s.jsxs)("div",{className:"house-status-container ".concat(T?"dark-mode":""),children:[(0,s.jsxs)("div",{className:"toolbar top-row",children:[(0,s.jsx)("div",{className:"left",children:(0,s.jsx)("h1",{children:"\ud83c\udfe8 House Status Report"})}),(0,s.jsxs)("div",{className:"right",children:[(0,s.jsx)("button",{onClick:()=>n(u(t)),children:"\u2b05 Previous Day"}),(0,s.jsx)("button",{onClick:()=>n(l(t)),children:"\u27a1 Next Day"}),(0,s.jsx)("input",{type:"date",value:t,onChange:e=>n(e.target.value)}),(0,s.jsx)("button",{onClick:async()=>{g(!0);try{await a.A.post("/house_status_report/house-status/block_save/",{date:t,rows:d}),_({type:"success",text:"All rooms saved successfully \u2705"})}catch(e){console.error(e),_({type:"error",text:"\u274c Error saving all rooms"})}finally{g(!1),setTimeout(()=>_(null),3e3)}},disabled:p,children:p?"\ud83d\udcbe Saving...":"\ud83d\udcbe Save All"}),(0,s.jsx)("button",{onClick:()=>window.print(),children:"\ud83d\udda8 Print"}),(0,s.jsx)("button",{onClick:()=>b(!T),children:T?"\ud83c\udf1e Light":"\ud83c\udf19 Dark"})]})]}),j&&(0,s.jsx)("div",{className:"message ".concat("error"===j.type?"message--err":"message--ok"),children:j.text}),(0,s.jsxs)("div",{className:"filters",children:[(0,s.jsx)("button",{className:"all"===w?"active":"",onClick:()=>v("all"),children:"All"}),(0,s.jsx)("button",{className:"occupied"===w?"active":"",onClick:()=>v("occupied"),children:"Occupied"}),(0,s.jsx)("button",{className:"unoccupied"===w?"active":"",onClick:()=>v("unoccupied"),children:"Vacant"}),(0,s.jsx)("button",{className:"outoforder"===w?"active":"",onClick:()=>v("outoforder"),children:"Out of Order"})]}),(0,s.jsx)("div",{className:"table-wrap",ref:f,children:(0,s.jsxs)("table",{className:"house-status-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Room"}),(0,s.jsx)("th",{children:"Type"}),(0,s.jsx)("th",{children:"Guest Name"}),(0,s.jsx)("th",{children:"Pax"}),(0,s.jsx)("th",{children:"Organization"}),(0,s.jsx)("th",{children:"Check In"}),(0,s.jsx)("th",{children:"Check Out"}),(0,s.jsx)("th",{children:"Requirements"}),(0,s.jsx)("th",{children:"Time"}),(0,s.jsx)("th",{children:"Rate"}),(0,s.jsx)("th",{children:"Save"})]})}),(0,s.jsx)("tbody",{children:m?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:"11",style:{textAlign:"center",padding:"40px"},children:"Loading data..."})}):D.map((e,n)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.room_number}),(0,s.jsx)("td",{children:e.room_type}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{value:e.guest_name,onChange:e=>k(n,"guest_name",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"number",value:e.pax,onChange:e=>k(n,"pax",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{value:e.organization,onChange:e=>k(n,"organization",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"date",value:e.check_in,onChange:e=>k(n,"check_in",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"date",value:e.check_out,onChange:e=>k(n,"check_out",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{value:e.requirements,onChange:e=>k(n,"requirements",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{value:e.time,onChange:e=>k(n,"time",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"number",step:"0.01",value:e.rate,onChange:e=>k(n,"rate",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{onClick:()=>(async e=>{try{await a.A.post("/house_status_report/house-status/",(0,o.A)({date:t},e)),_({type:"success",text:"Room ".concat(e.room_number," saved \u2705")})}catch(n){console.error(n),_({type:"error",text:"\u274c Error saving Room ".concat(e.room_number)})}finally{setTimeout(()=>_(null),3e3)}})(e),children:"\ud83d\udcbe"})})]},e.room_number))})]})})]})}}}]);
//# sourceMappingURL=788.85157c46.chunk.js.map