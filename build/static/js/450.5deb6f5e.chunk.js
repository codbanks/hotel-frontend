"use strict";(self.webpackChunkhotel_frontend=self.webpackChunkhotel_frontend||[]).push([[450],{450:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var s=n(43),l=n(931),a=n(579);const d={1:"Double",2:"Double",3:"Double",4:"Twin",5:"Twin",6:"Twin",7:"Twin",8:"Twin",9:"Twin",10:"Twin",11:"Twin",12:"Twin",13:"Twin",14:"Twin",15:"Twin",16:"Twin",17:"Twin",18:"Twin",19:"Twin",20:"Twin",21:"Twin",22:"Twin",23:"Twin",24:"Twin",25:"Double",26:"Double",27:"Twin",28:"Twin",29:"Twin",30:"Double",31:"Twin",32:"Twin",33:"Twin",34:"Twin",35:"Double",36:"Double",37:"Twin",38:"Twin",39:"Suite",40:"Suite",41:"Double",42:"Double",43:"Double",44:"Double",45:"Double",46:"Double",47:"Double",48:"Twin",49:"Double",50:"Double",51:"Single",52:"Single",53:"Single",54:"Twin",55:"Twin",56:"Twin",57:"Twin",58:"Single"},i=()=>{const[e,t]=(0,s.useState)((new Date).toISOString().split("T")[0]),[n,i]=(0,s.useState)([]),[o,c]=(0,s.useState)(!1),r=(0,s.useCallback)(async()=>{c(!0);try{const e=await l.A.get("/invoice/invoices/");i(e.data)}catch(e){console.error("API Error:",e)}finally{c(!1)}},[]);(0,s.useEffect)(()=>{r()},[r]);const u=n=>{const s=new Date(e);s.setDate(s.getDate()+n),t(s.toISOString().split("T")[0])},h=(0,s.useMemo)(()=>{const t=new Date(e),s=t.getDate(),l={day:{bednights:0,single:0,double:0,comp:0,house:0,ooo:0},mtd:{bednights:0,single:0,double:0,comp:0,house:0,ooo:0}},a=(e,t)=>t>=e.arrival_date&&t<e.departure_date;for(let T=1;T<=s;T++){const s=new Date(t);s.setDate(T);const i=s.toISOString().split("T")[0];n.forEach(t=>{if(a(t,i)){var n;const s=parseInt(t.room_no),a=d[s]||"Double",o=!0===t.is_house_use||(null===(n=t.guest_name)||void 0===n?void 0:n.toLowerCase().includes("house")),c="OOO"===t.status||!0===t.is_out_of_order,r=0===parseFloat(t.rate_allocated)&&!o&&!c;i===e&&(c?l.day.ooo++:o?l.day.house++:r?l.day.comp++:"Single"===a?l.day.single++:l.day.double++,c||(l.day.bednights+=parseInt(t.adults||0)+parseInt(t.children||0))),c?l.mtd.ooo++:o?l.mtd.house++:r?l.mtd.comp++:"Single"===a?l.mtd.single++:l.mtd.double++,c||(l.mtd.bednights+=parseInt(t.adults||0)+parseInt(t.children||0))}})}const i=function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return{label:e,day:{actual:t,budget:s,var:t-s},mtd:{actual:n,budget:l,var:n-l}}},o=l.day.single+l.day.double,c=l.mtd.single+l.mtd.double,r=o+l.day.comp+l.day.house,u=c+l.mtd.comp+l.mtd.house,h=58*s;return[i("BEDNIGHTS SOLD",l.day.bednights,l.mtd.bednights),i("SINGLE ROOMS",l.day.single,l.mtd.single),i("DOUBLE ROOMS",l.day.double,l.mtd.double),i("ROOMS SOLD",o,c),i("COMPLIMENTARY ROOMS",l.day.comp,l.mtd.comp),i("HOUSE USE",l.day.house,l.mtd.house),i("TOTAL ROOMS OCCUPIED",r,u),i("ROOMS AVAILABLE",58,h,58,58*s),i("VACANT ROOMS",58-r,h-u),i("OUT OF ORDER ROOMS",l.day.ooo,l.mtd.ooo),i("AVAILABLE TO SELL",58-l.day.ooo,h-l.mtd.ooo,58,58*s)]},[n,e]),T=e=>e<0?"neg":e>0?"pos":"";return(0,a.jsxs)("div",{className:"pumpkin-main",children:[(0,a.jsxs)("div",{className:"report-controls",children:[(0,a.jsx)("button",{className:"nav-ctrl",onClick:()=>u(-1),children:"PREVIOUS"}),(0,a.jsxs)("div",{className:"report-title",children:[(0,a.jsx)("h2",{children:"OCCUPANCY SALES ANALYSIS"}),(0,a.jsx)("span",{children:e})]}),(0,a.jsx)("button",{className:"nav-ctrl",onClick:()=>u(1),children:"NEXT"})]}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{className:"analysis-table",children:[(0,a.jsxs)("thead",{children:[(0,a.jsxs)("tr",{className:"main-th",children:[(0,a.jsx)("th",{rowSpan:"2",children:"LINE ITEMS"}),(0,a.jsx)("th",{colSpan:"3",children:"DAILY (ACTUAL)"}),(0,a.jsx)("th",{colSpan:"3",children:"MONTH TO DATE"})]}),(0,a.jsxs)("tr",{className:"sub-th",children:[(0,a.jsx)("th",{children:"ACTUAL"}),(0,a.jsx)("th",{children:"BUDGET"}),(0,a.jsx)("th",{children:"VAR"}),(0,a.jsx)("th",{children:"ACTUAL"}),(0,a.jsx)("th",{children:"BUDGET"}),(0,a.jsx)("th",{children:"VAR"})]})]}),(0,a.jsx)("tbody",{children:o?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"7",className:"loading",children:"Updating Statistics..."})}):h.map((e,t)=>(0,a.jsxs)("tr",{className:e.label.includes("TOTAL")||e.label.includes("SELL")?"row-bold":"",children:[(0,a.jsx)("td",{className:"row-label",children:e.label}),(0,a.jsx)("td",{children:e.day.actual}),(0,a.jsx)("td",{children:e.day.budget}),(0,a.jsx)("td",{className:T(e.day.var),children:e.day.var}),(0,a.jsx)("td",{children:e.mtd.actual}),(0,a.jsx)("td",{children:e.mtd.budget}),(0,a.jsx)("td",{className:T(e.mtd.var),children:e.mtd.var})]},t))})]})})]})}}}]);
//# sourceMappingURL=450.5deb6f5e.chunk.js.map