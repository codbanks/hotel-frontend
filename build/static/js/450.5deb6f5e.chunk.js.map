{"version":3,"file":"static/js/450.5deb6f5e.chunk.js","mappings":"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","sources":["pages/reports/OccupancySales.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport api from '../../api/api';\r\nimport '../../styles/OccupancySales.css';\r\n\r\n// --- ACCURATE ROOM MAPPING ---\r\nconst typeMap = {\r\n    1: \"Double\", 2: \"Double\", 3: \"Double\", 4: \"Twin\", 5: \"Twin\",\r\n    6: \"Twin\", 7: \"Twin\", 8: \"Twin\", 9: \"Twin\", 10: \"Twin\",\r\n    11: \"Twin\", 12: \"Twin\", 13: \"Twin\", 14: \"Twin\", 15: \"Twin\",\r\n    16: \"Twin\", 17: \"Twin\", 18: \"Twin\", 19: \"Twin\", 20: \"Twin\",\r\n    21: \"Twin\", 22: \"Twin\", 23: \"Twin\", 24: \"Twin\", 25: \"Double\",\r\n    26: \"Double\", 27: \"Twin\", 28: \"Twin\", 29: \"Twin\", 30: \"Double\",\r\n    31: \"Twin\", 32: \"Twin\", 33: \"Twin\", 34: \"Twin\", 35: \"Double\",\r\n    36: \"Double\", 37: \"Twin\", 38: \"Twin\", 39: \"Suite\", 40: \"Suite\",\r\n    41: \"Double\", 42: \"Double\", 43: \"Double\", 44: \"Double\", 45: \"Double\",\r\n    46: \"Double\", 47: \"Double\", 48: \"Twin\", 49: \"Double\", 50: \"Double\",\r\n    51: \"Single\", 52: \"Single\", 53: \"Single\", 54: \"Twin\", 55: \"Twin\",\r\n    56: \"Twin\", 57: \"Twin\", 58: \"Single\",\r\n};\r\n\r\nconst OccupancySales = () => {\r\n    const [currentDate, setCurrentDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Physical Capacity\r\n    const TOTAL_ROOMS_IN_HOTEL = 58;\r\n\r\n    const fetchData = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Fetching all invoices/house status records\r\n            const response = await api.get('/invoice/invoices/');\r\n            setInvoices(response.data);\r\n        } catch (err) {\r\n            console.error(\"API Error:\", err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [fetchData]);\r\n\r\n    const handleNavigate = (days) => {\r\n        const d = new Date(currentDate);\r\n        d.setDate(d.getDate() + days);\r\n        setCurrentDate(d.toISOString().split('T')[0]);\r\n    };\r\n\r\n    const reportData = useMemo(() => {\r\n        const selectedDateObj = new Date(currentDate);\r\n        const mtdDayCount = selectedDateObj.getDate();\r\n        \r\n        // Initializing all counters to 0 - No more dummy numbers\r\n        const stats = {\r\n            day: { bednights: 0, single: 0, double: 0, comp: 0, house: 0, ooo: 0 },\r\n            mtd: { bednights: 0, single: 0, double: 0, comp: 0, house: 0, ooo: 0 }\r\n        };\r\n\r\n        const isWithinStay = (inv, dateStr) => dateStr >= inv.arrival_date && dateStr < inv.departure_date;\r\n\r\n        for (let i = 1; i <= mtdDayCount; i++) {\r\n            const dateObj = new Date(selectedDateObj);\r\n            dateObj.setDate(i);\r\n            const dateStr = dateObj.toISOString().split('T')[0];\r\n\r\n            invoices.forEach(inv => {\r\n                if (isWithinStay(inv, dateStr)) {\r\n                    const roomNum = parseInt(inv.room_no);\r\n                    const type = typeMap[roomNum] || \"Double\";\r\n                    \r\n                    // Logic for Categorization\r\n                    const isHouseUse = inv.is_house_use === true || inv.guest_name?.toLowerCase().includes('house');\r\n                    const isOOO = inv.status === 'OOO' || inv.is_out_of_order === true;\r\n                    const isComp = parseFloat(inv.rate_allocated) === 0 && !isHouseUse && !isOOO;\r\n\r\n                    if (dateStr === currentDate) {\r\n                        if (isOOO) stats.day.ooo++;\r\n                        else if (isHouseUse) stats.day.house++;\r\n                        else if (isComp) stats.day.comp++;\r\n                        else if (type === \"Single\") stats.day.single++;\r\n                        else stats.day.double++;\r\n                        \r\n                        if (!isOOO) stats.day.bednights += (parseInt(inv.adults || 0) + parseInt(inv.children || 0));\r\n                    }\r\n\r\n                    // MTD Accumulation\r\n                    if (isOOO) stats.mtd.ooo++;\r\n                    else if (isHouseUse) stats.mtd.house++;\r\n                    else if (isComp) stats.mtd.comp++;\r\n                    else if (type === \"Single\") stats.mtd.single++;\r\n                    else stats.mtd.double++;\r\n                    \r\n                    if (!isOOO) stats.mtd.bednights += (parseInt(inv.adults || 0) + parseInt(inv.children || 0));\r\n                }\r\n            });\r\n        }\r\n\r\n        const createRow = (label, dAct, mAct, dBud = 0, mBud = 0) => ({\r\n            label,\r\n            day: { actual: dAct, budget: dBud, var: dAct - dBud },\r\n            mtd: { actual: mAct, budget: mBud, var: mAct - mBud }\r\n        });\r\n\r\n        // CALCULATIONS BASED ON EXCEL FORMULAS\r\n        const dSold = stats.day.single + stats.day.double;\r\n        const mSold = stats.mtd.single + stats.mtd.double;\r\n\r\n        const dTotalOcc = dSold + stats.day.comp + stats.day.house;\r\n        const mTotalOcc = mSold + stats.mtd.comp + stats.mtd.house;\r\n\r\n        const dRoomsAvail = TOTAL_ROOMS_IN_HOTEL;\r\n        const mRoomsAvail = TOTAL_ROOMS_IN_HOTEL * mtdDayCount;\r\n\r\n        return [\r\n            createRow(\"BEDNIGHTS SOLD\", stats.day.bednights, stats.mtd.bednights),\r\n            createRow(\"SINGLE ROOMS\", stats.day.single, stats.mtd.single),\r\n            createRow(\"DOUBLE ROOMS\", stats.day.double, stats.mtd.double),\r\n            createRow(\"ROOMS SOLD\", dSold, mSold),\r\n            createRow(\"COMPLIMENTARY ROOMS\", stats.day.comp, stats.mtd.comp),\r\n            createRow(\"HOUSE USE\", stats.day.house, stats.mtd.house),\r\n            createRow(\"TOTAL ROOMS OCCUPIED\", dTotalOcc, mTotalOcc),\r\n            createRow(\"ROOMS AVAILABLE\", dRoomsAvail, mRoomsAvail, 58, 58 * mtdDayCount),\r\n            createRow(\"VACANT ROOMS\", dRoomsAvail - dTotalOcc, mRoomsAvail - mTotalOcc),\r\n            createRow(\"OUT OF ORDER ROOMS\", stats.day.ooo, stats.mtd.ooo),\r\n            createRow(\"AVAILABLE TO SELL\", dRoomsAvail - stats.day.ooo, mRoomsAvail - stats.mtd.ooo, 58, 58 * mtdDayCount)\r\n        ];\r\n    }, [invoices, currentDate]);\r\n\r\n    const getVarClass = (v) => v < 0 ? 'neg' : v > 0 ? 'pos' : '';\r\n\r\n    return (\r\n        <div className=\"pumpkin-main\">\r\n            <div className=\"report-controls\">\r\n                <button className=\"nav-ctrl\" onClick={() => handleNavigate(-1)}>PREVIOUS</button>\r\n                <div className=\"report-title\">\r\n                    <h2>OCCUPANCY SALES ANALYSIS</h2>\r\n                    <span>{currentDate}</span>\r\n                </div>\r\n                <button className=\"nav-ctrl\" onClick={() => handleNavigate(1)}>NEXT</button>\r\n            </div>\r\n\r\n            <div className=\"table-wrapper\">\r\n                <table className=\"analysis-table\">\r\n                    <thead>\r\n                        <tr className=\"main-th\">\r\n                            <th rowSpan=\"2\">LINE ITEMS</th>\r\n                            <th colSpan=\"3\">DAILY (ACTUAL)</th>\r\n                            <th colSpan=\"3\">MONTH TO DATE</th>\r\n                        </tr>\r\n                        <tr className=\"sub-th\">\r\n                            <th>ACTUAL</th><th>BUDGET</th><th>VAR</th>\r\n                            <th>ACTUAL</th><th>BUDGET</th><th>VAR</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {loading ? (\r\n                            <tr><td colSpan=\"7\" className=\"loading\">Updating Statistics...</td></tr>\r\n                        ) : reportData.map((row, idx) => (\r\n                            <tr key={idx} className={row.label.includes('TOTAL') || row.label.includes('SELL') ? 'row-bold' : ''}>\r\n                                <td className=\"row-label\">{row.label}</td>\r\n                                <td>{row.day.actual}</td>\r\n                                <td>{row.day.budget}</td>\r\n                                <td className={getVarClass(row.day.var)}>{row.day.var}</td>\r\n                                <td>{row.mtd.actual}</td>\r\n                                <td>{row.mtd.budget}</td>\r\n                                <td className={getVarClass(row.mtd.var)}>{row.mtd.var}</td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OccupancySales;"],"names":["typeMap","OccupancySales","currentDate","setCurrentDate","useState","Date","toISOString","split","invoices","setInvoices","loading","setLoading","fetchData","useCallback","async","response","api","get","data","err","console","error","useEffect","handleNavigate","days","d","setDate","getDate","reportData","useMemo","selectedDateObj","mtdDayCount","stats","day","bednights","single","double","comp","house","ooo","mtd","isWithinStay","inv","dateStr","arrival_date","departure_date","i","dateObj","forEach","_inv$guest_name","roomNum","parseInt","room_no","type","isHouseUse","is_house_use","guest_name","toLowerCase","includes","isOOO","status","is_out_of_order","isComp","parseFloat","rate_allocated","adults","children","createRow","label","dAct","mAct","dBud","arguments","length","undefined","mBud","actual","budget","var","dSold","mSold","dTotalOcc","mTotalOcc","mRoomsAvail","getVarClass","v","_jsxs","className","_jsx","onClick","rowSpan","colSpan","map","row","idx"],"sourceRoot":""}